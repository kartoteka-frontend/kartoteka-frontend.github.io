import{E as h}from"./ErrorMsg.63b7f0cc.js";import{r as c,o as a,c as n,a as i,k as l,v as u,l as d,F as w,d as p,b as y,p as _,m as v}from"./vendor.777750b5.js";import{_ as k}from"./index.9a78927e.js";const f={name:"Login",components:{ErrorMsg:h},data(){return{email:"",password:"",name:"",auth:!1,registration:!1,error:""}},methods:{async login(){try{const s=await this.$api.login(this.email,this.password);window.localStorage.setItem("Auth-Token",s.data),this.$router.push({name:"home"})}catch(s){this.error=s.response.data}},async register(){if(!this.registration){this.registration=!0;return}try{await this.$api.register(this.email,this.password,this.name);const s=await this.$api.login(this.email,this.password);window.localStorage.setItem("Auth-Token",s.data),this.$router.push({name:"home"})}catch(s){this.error=s.response.data}},logout(){window.localStorage.clear(),this.auth=!1},async authorize(){const s=window.localStorage.getItem("Auth-Token");if(s)try{await this.$api.verify(s),this.auth=!0}catch(e){console.log(e.response.data)}}},async created(){this.authorize()}},m=s=>(_("data-v-6403819b"),s=s(),v(),s),V={class:"login"},b=m(()=>i("h1",null,"Vitaj v kartot\xE9ke!",-1)),x={key:0},I={class:"inputs"},S=m(()=>i("br",null,null,-1)),E=m(()=>i("br",null,null,-1)),B={key:1};function C(s,e,M,K,o,r){const g=c("ErrorMsg");return a(),n("div",V,[b,o.auth?(a(),n("div",B,[i("button",{onClick:e[8]||(e[8]=(...t)=>r.logout&&r.logout(...t))},"Odhl\xE1si\u0165 sa")])):(a(),n("div",x,[i("div",I,[l(i("input",{type:"text",id:"email",placeholder:"Email",name:"email","onUpdate:modelValue":e[0]||(e[0]=t=>o.email=t),onKeyup:e[1]||(e[1]=d((...t)=>r.login&&r.login(...t),["enter"]))},null,544),[[u,o.email]]),S,l(i("input",{type:"password",id:"password",placeholder:"Heslo",name:"password","onUpdate:modelValue":e[2]||(e[2]=t=>o.password=t),onKeyup:e[3]||(e[3]=d((...t)=>r.login&&r.login(...t),["enter"]))},null,544),[[u,o.password]]),o.registration?(a(),n(w,{key:0},[E,l(i("input",{type:"text",id:"name",placeholder:"Meno",name:"name","onUpdate:modelValue":e[4]||(e[4]=t=>o.name=t),onKeyup:e[5]||(e[5]=d((...t)=>r.register&&r.register(...t),["enter"]))},null,544),[[u,o.name]])],64)):p("",!0)]),i("div",null,[y(g,{message:o.error},null,8,["message"])]),o.registration?p("",!0):(a(),n("button",{key:0,class:"loginButton",onClick:e[6]||(e[6]=(...t)=>r.login&&r.login(...t))},"Prihl\xE1si\u0165 sa")),i("button",{class:"registerButton",onClick:e[7]||(e[7]=(...t)=>r.register&&r.register(...t))},"Registrova\u0165 sa")]))])}var N=k(f,[["render",C],["__scopeId","data-v-6403819b"]]);export{N as default};
