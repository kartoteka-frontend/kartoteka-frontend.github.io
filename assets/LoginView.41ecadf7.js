import{E as h}from"./ErrorMsg.f730eec0.js";import{h as w,o as i,c as n,a,g as l,v as d,p as u,F as c,d as g,b as y,q as _,s as v}from"./vendor.db9d2b8c.js";import{_ as k}from"./index.4c48ccff.js";const f={name:"Login",components:{ErrorMsg:h},data(){return{email:"",password:"",name:"",auth:!1,registration:!1,error:""}},methods:{async login(){try{const t=await this.$api.login(this.email,this.password);window.localStorage.setItem("Auth-Token",t.data.token),window.localStorage.setItem("user",t.data.name),this.$router.push({name:"home"})}catch(t){this.error=t.response.data}},async register(){if(!this.registration){this.registration=!0;return}try{await this.$api.register(this.email,this.password,this.name);const t=await this.$api.login(this.email,this.password);window.localStorage.setItem("Auth-Token",t.data.token),window.localStorage.setItem("user",t.data.name),this.$router.push({name:"home"})}catch(t){this.error=t.response.data}},logout(){window.localStorage.clear(),this.auth=!1},async authorize(){const t=window.localStorage.getItem("Auth-Token");if(t)try{await this.$api.verify(t),this.auth=!0}catch(e){console.log(e.response.data)}}},async created(){this.authorize()}},m=t=>(_("data-v-237696a5"),t=t(),v(),t),I={class:"login"},S=m(()=>a("h1",null,"Vitaj v kartot\xE9ke!",-1)),V={key:0},x={class:"inputs"},b=m(()=>a("br",null,null,-1)),E=m(()=>a("br",null,null,-1)),B={key:1};function C(t,e,M,K,r,o){const p=w("ErrorMsg");return i(),n("div",I,[S,r.auth?(i(),n("div",B,[a("button",{onClick:e[8]||(e[8]=(...s)=>o.logout&&o.logout(...s))},"Odhl\xE1si\u0165 sa")])):(i(),n("div",V,[a("div",x,[l(a("input",{type:"text",id:"email",placeholder:"Email",name:"email","onUpdate:modelValue":e[0]||(e[0]=s=>r.email=s),onKeyup:e[1]||(e[1]=u((...s)=>o.login&&o.login(...s),["enter"]))},null,544),[[d,r.email]]),b,l(a("input",{type:"password",id:"password",placeholder:"Heslo",name:"password","onUpdate:modelValue":e[2]||(e[2]=s=>r.password=s),onKeyup:e[3]||(e[3]=u((...s)=>o.login&&o.login(...s),["enter"]))},null,544),[[d,r.password]]),r.registration?(i(),n(c,{key:0},[E,l(a("input",{type:"text",id:"name",placeholder:"Meno",name:"name","onUpdate:modelValue":e[4]||(e[4]=s=>r.name=s),onKeyup:e[5]||(e[5]=u((...s)=>o.register&&o.register(...s),["enter"]))},null,544),[[d,r.name]])],64)):g("",!0)]),a("div",null,[y(p,{message:r.error},null,8,["message"])]),r.registration?g("",!0):(i(),n("button",{key:0,class:"loginButton",onClick:e[6]||(e[6]=(...s)=>o.login&&o.login(...s))},"Prihl\xE1si\u0165 sa")),a("button",{class:"registerButton",onClick:e[7]||(e[7]=(...s)=>o.register&&o.register(...s))},"Registrova\u0165 sa")]))])}var N=k(f,[["render",C],["__scopeId","data-v-237696a5"]]);export{N as default};
